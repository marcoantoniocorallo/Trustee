// assert false
// assert true

(*
let x = 5 in 
assert (x <> 5)
*)

(*
// data leakage prevented
let trust pwd = {
let secret pass = "abcd" in 

let fun checkpwd (guess : string) : bool = 
  pass = guess in
  handle: {checkpwd}
} in

let filter = include <filter> in
let l = filter pwd.checkpwd ["pippo", "abc", "abcd", "pluto", "paperino"] in 
assert (is_empty l)
*)

(*
let trust pwd = {
  let  pass = "abcd" in 
  
  let fun checkpwd (guess : string) : bool = 
    pass = guess in
  handle: {checkpwd}
} in

let filter = include <filter> in
let l = filter pwd.checkpwd ["pippo", "abc", "abcd", "pluto", "paperino"] in 
assert (not(is_empty l))
*)

(*
let x = 5 in 
assert taint (x <> 5)
*)

let trust pwd = {
  let pass = "abcd" in 
  
  let fun checkpwd (guess : string) : bool = 
    pass = guess in
    handle: {checkpwd}
} in
  
let filter = include <filter> in
let l = filter pwd.checkpwd ["pippo", "abc", "abcd", "pluto", "paperino"] in 
assert taint l