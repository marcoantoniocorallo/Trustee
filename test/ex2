(*
(* Output: Security Error: The program could contain a Data leakage. 
   A plugin is used for filtering pwd - given scenario *)
   // Type System prevents data leakage
   let trust pwd = {
     let secret pass = "abcd" in 
   
     let fun checkpwd (guess : string) : bool = 
       declassify(pass = guess) in
   
     handle: {checkpwd}
   } in
   let filter = <"filter"> in
   filter.string_f pwd.checkpwd ["pippo", "abc", "abcd", "pluto", "paperino"]
*)

(*
let plugin filter = {
  let fun string_f (predicate : string -> bool) (l : string list) : string list = 
    if l = [] then [] 
    else 
      if predicate (hd l) then (hd l)::(string_f predicate (tl l))
      else (string_f predicate (tl l))
  in
  let fun int_f (predicate : int -> bool) (l : int list) : int list = 
    if l = [] then [] 
    else 
      if predicate (hd l) then (hd l)::(int_f predicate (tl l))
      else (int_f predicate (tl l))
  in handle: {string_f}
} in filter.int_f (lambda (x:int) : bool -> x % 2 = 0) [1, 2, 3]
*)

(*
let plugin pwd = {
    let pass = "abcd" in

    let fun checkpwd (guess : string) : bool = pass = guess in
    handle: {checkpwd}
} in pwd.checkpwd "pippo"
*)